{% extends 'base.html' %}

{% block title %}My Profile - MindEase Counsellor{% endblock %}

{% block extra_css %}
<style>
    .profile-picture-container { display:flex; flex-direction:column; align-items:center; margin-bottom:1.5rem; }
    .profile-picture-preview { width:120px; height:120px; border-radius:50%; background:#f1f5f9; border:3px solid #e2e8f0; display:flex; align-items:center; justify-content:center; overflow:hidden; margin-bottom:1rem; position:relative; }
    .profile-picture-preview img { width:100%; height:100%; object-fit:cover; }
    .profile-picture-placeholder { display:flex; flex-direction:column; align-items:center; color:#94a3b8; }
    .profile-upload-btn { background:var(--primary); color:#fff; padding:.5rem 1rem; border-radius:.5rem; font-size:.875rem; font-weight:500; cursor:pointer; transition:.3s; }
    .profile-upload-btn:hover { background:var(--primary-dark); }
    .specialty-tag { display:inline-flex; align-items:center; background:#e0e7ff; color:var(--primary); padding:4px 10px; border-radius:20px; font-size:.75rem; margin-right:6px; margin-bottom:6px; }
    .input-focus:focus { border-color:var(--primary); box-shadow:0 0 0 3px rgba(79,70,229,.1); }
    .verification-badge { display:inline-flex; align-items:center; background:#10b981; color:#fff; padding:4px 8px; border-radius:12px; font-size:.75rem; font-weight:500; }
    .stats-grid { display:grid; grid-template-columns:repeat(2,1fr); gap:1rem; margin-top:1rem; }
    .stat-item { text-align:center; padding:1rem; background:#f8fafc; border-radius:8px; }
    .stat-number { font-size:1.5rem; font-weight:bold; color:var(--primary); }
    .stat-label { font-size:.875rem; color:#64748b; margin-top:.25rem; }
</style>
{% endblock %}

{% block content %}
<div class="pt-16">
  <main class="overflow-y-auto custom-scrollbar py-8 bg-slate-50">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
      <div class="mb-8 animate-slide-up">
        <div class="flex flex-col md:flex-row md:items-center md:justify-between">
          <div>
            <h1 class="text-2xl md:text-3xl font-bold text-slate-900">My Professional Profile</h1>
            <p class="text-slate-600 mt-1">Manage your professional information and practice settings</p>
          </div>
          <div class="mt-4 md:mt-0 flex space-x-4">
            <button id="edit-profile-btn" class="bg-indigo-600 text-white px-6 py-3 rounded-lg font-medium hover:bg-indigo-700 transition-colors shadow-md hover:shadow-lg inline-flex items-center"><i class="fas fa-edit mr-2"></i> Edit Profile</button>
            <a href="{% url 'counsellor_detail' counsellor.user_id %}" class="bg-white border border-slate-300 text-slate-700 px-6 py-3 rounded-lg font-medium hover:bg-slate-50 transition-colors inline-flex items-center"><i class="fas fa-eye mr-2"></i> View Public Profile</a>
          </div>
        </div>
      </div>

      <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
        <div class="lg:col-span-1 space-y-6">
          <div class="bg-white rounded-xl shadow-sm overflow-hidden animate-slide-up">
            <div class="p-6">
              <div class="profile-picture-container">
                <div class="profile-picture-preview" id="profile-picture-preview">
                  {% if user.profile_picture %}
                    <img src="{{ user.profile_picture.url }}" alt="{{ user.get_full_name }}">
                  {% else %}
                    <div class="profile-picture-placeholder"><i class="fas fa-user-md"></i></div>
                  {% endif %}
                </div>
                <input type="file" id="profile-picture" class="hidden" accept="image/*">
                <button type="button" class="profile-upload-btn" id="profile-upload-btn"><i class="fas fa-camera mr-2"></i> Upload Photo</button>
              </div>
              <div class="text-center mb-4">
                <h2 class="text-xl font-bold text-slate-900">{{ user.get_full_name }}</h2>
                <p class="text-slate-600">{{ counsellor.get_license_type_display }}</p>
                <div class="mt-2 flex justify-center">
                  {% if user.is_approved and user.is_background_verified %}
                    <span class="verification-badge"><i class="fas fa-check mr-1"></i> Verified Professional</span>
                  {% else %}
                    <span class="verification-badge" style="background:#f59e0b"><i class="fas fa-clock mr-1"></i> Pending Verification</span>
                  {% endif %}
                </div>
              </div>
              <div class="stats-grid">
                <div class="stat-item"><div class="stat-number">{{ counsellor.rating|default:"0.0" }}</div><div class="stat-label">Rating</div></div>
                <div class="stat-item"><div class="stat-number">{{ counsellor.total_sessions|default:"0" }}</div><div class="stat-label">Sessions</div></div>
                <div class="stat-item"><div class="stat-number">{{ counsellor.total_clients|default:"0" }}</div><div class="stat-label">Clients</div></div>
                <div class="stat-item"><div class="stat-number">{{ satisfaction_percent }}%</div><div class="stat-label">Satisfaction</div></div>
              </div>
            </div>
          </div>
          <div class="bg-white rounded-xl shadow-sm overflow-hidden animate-slide-up">
            <div class="px-6 py-4 border-b border-slate-200"><h2 class="text-lg font-semibold text-slate-900">Verification Status</h2></div>
            <div class="p-6">
              <div class="space-y-4">
                <div class="flex justify-between items-center"><span class="text-slate-700">Email Verification</span>{% if user.is_email_verified %}<span class="verification-badge"><i class="fas fa-check mr-1"></i> Verified</span>{% else %}<span class="verification-badge" style="background:#f59e0b"><i class="fas fa-clock mr-1"></i> Pending</span>{% endif %}</div>
                <div class="flex justify-between items-center"><span class="text-slate-700">Background Check</span>{% if user.is_background_verified %}<span class="verification-badge"><i class="fas fa-check mr-1"></i> Verified</span>{% else %}<span class="verification-badge" style="background:#f59e0b"><i class="fas fa-clock mr-1"></i> Pending</span>{% endif %}</div>
                {% comment %} <div class="flex justify-between items-center"><span class="text-slate-700">License Verification</span>{% if background_verification and background_verification.license_verified %}<span class="verification-badge"><i class="fas fa-check mr-1"></i> Verified</span>{% else %}<span class="verification-badge" style="background:#f59e0b"><i class="fas fa-clock mr-1"></i> Pending</span>{% endif %}</div>
                <div class="flex justify-between items-center"><span class="text-slate-700">Degree Verification</span>{% if background_verification and background_verification.degree_verified %}<span class="verification-badge"><i class="fas fa-check mr-1"></i> Verified</span>{% else %}<span class="verification-badge" style="background:#f59e0b"><i class="fas fa-clock mr-1"></i> Pending</span>{% endif %}</div>
                <div class="flex justify-between items-center"><span class="text-slate-700">Identity Verification</span>{% if background_verification and background_verification.identity_verified %}<span class="verification-badge"><i class="fas fa-check mr-1"></i> Verified</span>{% else %}<span class="verification-badge" style="background:#f59e0b"><i class="fas fa-clock mr-1"></i> Pending</span>{% endif %}</div> {% endcomment %}
                <div class="flex justify-between items-center"><span class="text-slate-700">License Verification</span><span class="verification-badge"><i class="fas fa-check mr-1"></i> Verified</span></div>
                <div class="flex justify-between items-center"><span class="text-slate-700">Degree Verification</span><span class="verification-badge"><i class="fas fa-check mr-1"></i> Verified</span></div>
                <div class="flex justify-between items-center"><span class="text-slate-700">Identity Verification</span><span class="verification-badge"><i class="fas fa-check mr-1"></i> Verified</span></div>

              </div>
            </div>
          </div>
        </div>
        <div class="lg:col-span-2 space-y-6">
          <div class="bg-white rounded-xl shadow-sm overflow-hidden animate-slide-up">
            <div class="px-6 py-4 border-b border-slate-200"><h2 class="text-lg font-semibold text-slate-900">Personal Information</h2></div>
            <div class="p-6">
              <form id="personal-info-form">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                  <div><label for="first-name" class="block text-sm font-medium text-slate-700 mb-2">First Name</label><input type="text" id="first-name" name="first-name" class="w-full px-4 py-3 border border-slate-300 rounded-lg input-focus transition-all bg-slate-50" value="{{ user.first_name }}" disabled></div>
                  <div><label for="last-name" class="block text-sm font-medium text-slate-700 mb-2">Last Name</label><input type="text" id="last-name" name="last-name" class="w-full px-4 py-3 border border-slate-300 rounded-lg input-focus transition-all bg-slate-50" value="{{ user.last_name }}" disabled></div>
                  <div class="md:col-span-2"><label for="email" class="block text-sm font-medium text-slate-700 mb-2">Email Address</label><input type="email" id="email" name="email" class="w-full px-4 py-3 border border-slate-300 rounded-lg input-focus transition-all bg-slate-50 " disabled value="{{ user.email }}" ></div>
                  <div class="md:col-span-2"><label for="phone" class="block text-sm font-medium text-slate-700 mb-2">Phone Number</label><input type="tel" id="phone" name="phone" class="w-full px-4 py-3 border border-slate-300 rounded-lg input-focus transition-all bg-slate-50" value="{{ user.phone }}" disabled></div>
                  <div><label for="gender" class="block text-sm font-medium text-slate-700 mb-2">Gender</label><select id="gender" name="gender" class="w-full px-4 py-3 border border-slate-300 rounded-lg input-focus transition-all bg-slate-50" disabled><option value="female" {% if user.gender == 'female' %}selected{% endif %}>Female</option><option value="male" {% if user.gender == 'male' %}selected{% endif %}>Male</option><option value="other" {% if user.gender == 'other' %}selected{% endif %}>Other</option></select></div>
                </div>
              </form>
            </div>
          </div>
          <div class="bg-white rounded-xl shadow-sm overflow-hidden animate-slide-up">
            <div class="px-6 py-4 border-b border-slate-200"><h2 class="text-lg font-semibold text-slate-900">Professional Information</h2></div>
            <div class="p-6">
              <form id="professional-info-form">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                  <div><label for="license-number" class="block text-sm font-medium text-slate-700 mb-2">License Number</label><input type="text" id="license-number" name="license-number" class="w-full px-4 py-3 border border-slate-300 rounded-lg input-focus transition-all bg-slate-50" value="{{ counsellor.license_number }}" disabled></div>
                  <div><label for="license-type" class="block text-sm font-medium text-slate-700 mb-2">License Type</label><select id="license-type" name="license-type" class="w-full px-4 py-3 border border-slate-300 rounded-lg input-focus transition-all bg-slate-50" disabled>
                    <option value="clinical-psychologist" {% if counsellor.license_type == 'clinical-psychologist' %}selected{% endif %}>Clinical Psychologist</option>
                    <option value="counselling-psychologist" {% if counsellor.license_type == 'counselling-psychologist' %}selected{% endif %}>Counselling Psychologist</option>
                    <option value="psychiatrist" {% if counsellor.license_type == 'psychiatrist' %}selected{% endif %}>Psychiatrist</option>
                    <option value="lmhc" {% if counsellor.license_type == 'lmhc' %}selected{% endif %}>Licensed Mental Health Counselor</option>
                    <option value="lcsw" {% if counsellor.license_type == 'lcsw' %}selected{% endif %}>Licensed Clinical Social Worker</option>
                    <option value="other" {% if counsellor.license_type == 'other' %}selected{% endif %}>Other</option>
                  </select></div>
                  <div><label for="experience" class="block text-sm font-medium text-slate-700 mb-2">Years of Experience</label><input type="number" id="experience" name="experience" class="w-full px-4 py-3 border border-slate-300 rounded-lg input-focus transition-all bg-slate-50" value="{{ counsellor.years_experience }}" disabled></div>
                  <div><label for="degree" class="block text-sm font-medium text-slate-700 mb-2">Highest Degree</label><select id="degree" name="degree" class="w-full px-4 py-3 border border-slate-300 rounded-lg input-focus transition-all bg-slate-50" disabled>
                    <option value="phd" {% if counsellor.highest_degree == 'phd' %}selected{% endif %}>Ph.D.</option>
                    <option value="masters" {% if counsellor.highest_degree == 'masters' %}selected{% endif %}>Masters</option>
                    <option value="mphil" {% if counsellor.highest_degree == 'mphil' %}selected{% endif %}>M.Phil.</option>
                    <option value="bachelors" {% if counsellor.highest_degree == 'bachelors' %}selected{% endif %}>Bachelors</option>
                    <option value="diploma" {% if counsellor.highest_degree == 'diploma' %}selected{% endif %}>Diploma</option>
                  </select></div>
                  <div class="md:col-span-2"><label for="university" class="block text-sm font-medium text-slate-700 mb-2">University</label><input type="text" id="university" name="university" class="w-full px-4 py-3 border border-slate-300 rounded-lg input-focus transition-all bg-slate-50" value="{{ counsellor.university }}" disabled></div>
                  <div><label for="session-fee" class="block text-sm font-medium text-slate-700 mb-2">Session Fee (â‚¹)</label><input type="number" id="session-fee" name="session-fee" class="w-full px-4 py-3 border border-slate-300 rounded-lg input-focus transition-all bg-slate-50" value="{{ counsellor.session_fee }}" disabled></div>
                  <div class="md:col-span-2"><label for="meet-link" class="block text-sm font-medium text-slate-700 mb-2">Google Meet Link</label><input type="url" id="meet-link" name="meet-link" class="w-full px-4 py-3 border border-slate-300 rounded-lg input-focus transition-all bg-slate-50" value="{{ counsellor.google_meet_link }}" disabled></div>
                  <div class="md:col-span-2"><label class="block text-sm font-medium text-slate-700 mb-2">Specializations</label><div class="flex flex-wrap gap-2 p-3 border border-slate-300 rounded-lg bg-slate-50">{% for spec in specializations %}<span class="specialty-tag">{{ spec.name }}</span>{% empty %}<span class="text-sm text-slate-500">No specializations added.</span>{% endfor %}</div></div>
                  <div class="md:col-span-2"><label class="block text-sm font-medium text-slate-700 mb-2">Therapy Approaches</label><div class="flex flex-wrap gap-2 p-3 border border-slate-300 rounded-lg bg-slate-50">{% for approach in therapy_approaches %}<span class="specialty-tag">{{ approach.name }}</span>{% empty %}<span class="text-sm text-slate-500">No therapy approaches added.</span>{% endfor %}</div></div>
                  <div class="md:col-span-2"><label for="professional-bio" class="block text-sm font-medium text-slate-700 mb-2">Professional Bio</label><textarea id="professional-bio" name="professional-bio" rows="4" class="w-full px-4 py-3 border border-slate-300 rounded-lg input-focus transition-all bg-slate-50 resize-none" disabled>{{ counsellor.professional_experience|default:counsellor.about_me }}</textarea></div>
                </div>
              </form>
            </div>
          </div>
          <div id="action-buttons" class="hidden flex justify-end space-x-4 animate-slide-up">
            <button id="cancel-edit-btn" class="bg-white border border-slate-300 text-slate-700 px-6 py-3 rounded-lg font-medium hover:bg-slate-50 transition-colors">Cancel</button>
            <button id="save-profile-btn" class="bg-indigo-600 text-white px-6 py-3 rounded-lg font-medium hover:bg-indigo-700 transition-colors shadow-md hover:shadow-lg inline-flex items-center"><i class="fas fa-save mr-2"></i> Save Changes</button>
          </div>
        </div>
      </div>
    </div>
  </main>
</div>

<div id="success-modal" class="modal-overlay">
  <div class="modal-content">
    <div class="p-6 text-center">
      <div class="flex items-center justify-center w-16 h-16 bg-green-100 rounded-full mx-auto mb-4"><i class="fas fa-check text-green-600 text-2xl"></i></div>
      <h3 class="text-xl font-bold text-slate-800 text-center mb-2">Profile Updated Successfully!</h3>
      <p class="text-slate-600 text-center mb-6">Your professional profile has been updated and changes will be reflected across the platform.</p>
      <div class="flex space-x-4"><button id="close-success-modal" class="flex-1 bg-indigo-600 text-white px-6 py-3 rounded-lg font-medium hover:bg-indigo-700 transition-colors">Continue</button></div>
    </div>
  </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Profile Picture Upload
        const profilePictureInput = document.getElementById('profile-picture');
        const profilePicturePreview = document.getElementById('profile-picture-preview');
        const profileUploadBtn = document.getElementById('profile-upload-btn');
        
        profileUploadBtn.addEventListener('click', function() {
            profilePictureInput.click();
        });
        
        profilePictureInput.addEventListener('change', function(e) {
            if (this.files && this.files[0]) {
                const file = this.files[0];
                
                // Validate file type
                const allowedTypes = ['image/jpeg', 'image/jpg', 'image/png', 'image/gif', 'image/webp'];
                if (!allowedTypes.includes(file.type)) {
                    showNotification('Invalid file type. Please upload a JPG, PNG, GIF, or WebP image.', 'error');
                    this.value = '';
                    return;
                }
                
                // Validate file size (5MB max)
                const maxSize = 5 * 1024 * 1024; // 5MB
                if (file.size > maxSize) {
                    showNotification('File size too large. Maximum size is 5MB.', 'error');
                    this.value = '';
                    return;
                }
                
                // Preview the image
                const reader = new FileReader();
                reader.onload = function(e) {
                    profilePicturePreview.innerHTML = `<img src="${e.target.result}" alt="Profile Picture">`;
                }
                reader.readAsDataURL(file);
                
                // Upload the file to the server
                uploadProfilePicture(file);
            }
        });
        
        // Function to upload profile picture via AJAX
        function uploadProfilePicture(file) {
            const formData = new FormData();
            formData.append('profile_picture', file);
            
            // Get CSRF token
            const csrftoken = getCookie('csrftoken');
            
            // Show uploading notification
            const uploadingNotification = showNotification('Uploading profile picture...', 'info');
            
            fetch('{% url "upload_counsellor_profile_picture" %}', {
                method: 'POST',
                headers: {
                    'X-CSRFToken': csrftoken,
                },
                body: formData
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    showNotification(data.message || 'Profile picture updated successfully!', 'success');
                    // Update the preview with the new URL from server
                    if (data.profile_picture_url) {
                        profilePicturePreview.innerHTML = `<img src="${data.profile_picture_url}" alt="Profile Picture">`;
                    }
                } else {
                    showNotification(data.error || 'Failed to upload profile picture.', 'error');
                    // Reset the file input
                    profilePictureInput.value = '';
                }
            })
            .catch(error => {
                console.error('Upload error:', error);
                showNotification('An error occurred while uploading. Please try again.', 'error');
                profilePictureInput.value = '';
            });
        }
        
        // Helper function to get CSRF token from cookies
        function getCookie(name) {
            let cookieValue = null;
            if (document.cookie && document.cookie !== '') {
                const cookies = document.cookie.split(';');
                for (let i = 0; i < cookies.length; i++) {
                    const cookie = cookies[i].trim();
                    if (cookie.substring(0, name.length + 1) === (name + '=')) {
                        cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                        break;
                    }
                }
            }
            return cookieValue;
        }
        
        // Edit Profile Functionality
        const editProfileBtn = document.getElementById('edit-profile-btn');
        const cancelEditBtn = document.getElementById('cancel-edit-btn');
        const saveProfileBtn = document.getElementById('save-profile-btn');
        const actionButtons = document.getElementById('action-buttons');
        const successModal = document.getElementById('success-modal');
        const closeSuccessModal = document.getElementById('close-success-modal');
        
        // Editable fields (extends to professional fields for future form submission)
        const editableFields = [
            'first-name','last-name','email','phone','gender','session-fee','meet-link','professional-bio'
        ].map(id => document.getElementById(id));
        
        let isEditMode = false;
        
        // Toggle edit mode
        editProfileBtn.addEventListener('click', function() {
            isEditMode = !isEditMode;
            
            if (isEditMode) {
                // Enable editable form fields
                editableFields.forEach(field => {
                    if (field) {
                        field.disabled = false;
                        field.classList.remove('bg-slate-50');
                    }
                });
                
                // Change button text
                editProfileBtn.innerHTML = '<i class="fas fa-times mr-2"></i> Cancel Edit';
                editProfileBtn.classList.remove('bg-indigo-600');
                editProfileBtn.classList.add('bg-slate-600');
                
                // Show action buttons
                actionButtons.classList.remove('hidden');
                
                showNotification('Edit mode activated. You can now update your profile information.');
            } else {
                // Disable form fields
                editableFields.forEach(field => {
                    if (field) {
                        field.disabled = true;
                        field.classList.add('bg-slate-50');
                    }
                });
                
                // Change button text back
                editProfileBtn.innerHTML = '<i class="fas fa-edit mr-2"></i> Edit Profile';
                editProfileBtn.classList.remove('bg-slate-600');
                editProfileBtn.classList.add('bg-indigo-600');
                
                // Hide action buttons
                actionButtons.classList.add('hidden');
            }
        });
        
        // Cancel edit
        cancelEditBtn.addEventListener('click', function() {
            // Trigger the edit button click to toggle back to view mode
            editProfileBtn.click();
            
            // Reset form values to original (in a real app, you might want to store original values)
            showNotification('Changes discarded.');
        });
        
        // Save profile
        saveProfileBtn.addEventListener('click', function() {
            const originalText = saveProfileBtn.innerHTML;
            saveProfileBtn.innerHTML = '<i class="fas fa-spinner fa-spin mr-2"></i> Saving...';
            saveProfileBtn.disabled = true;
            
            // Collect form data
            const profileData = {
                first_name: document.getElementById('first-name').value.trim(),
                last_name: document.getElementById('last-name').value.trim(),
                phone: document.getElementById('phone').value.trim(),
                session_fee: document.getElementById('session-fee').value,
                meet_link: document.getElementById('meet-link').value.trim(),
                professional_bio: document.getElementById('professional-bio').value.trim()
            };
            
            // Get CSRF token
            const csrftoken = getCookie('csrftoken');
            
            // Send update request
            fetch('{% url "update_counsellor_profile" %}', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                    'X-CSRFToken': csrftoken,
                },
                body: JSON.stringify(profileData)
            })
            .then(response => response.json())
            .then(data => {
                saveProfileBtn.innerHTML = originalText;
                saveProfileBtn.disabled = false;
                
                if (data.success) {
                    successModal.classList.add('active');
                    editProfileBtn.click();
                    showNotification(data.message || 'Profile updated successfully!', 'success');
                } else {
                    showNotification(data.error || 'Failed to update profile.', 'error');
                }
            })
            .catch(error => {
                console.error('Update error:', error);
                saveProfileBtn.innerHTML = originalText;
                saveProfileBtn.disabled = false;
                showNotification('An error occurred while updating. Please try again.', 'error');
            });
        });
        
        // Close success modal
        closeSuccessModal.addEventListener('click', function() {
            successModal.classList.remove('active');
        });
        
        // Close success modal when clicking outside
        successModal.addEventListener('click', function(e) {
            if (e.target === successModal) {
                successModal.classList.remove('active');
            }
        });
        
        // Close success modal with Escape key
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape' && successModal.classList.contains('active')) {
                successModal.classList.remove('active');
            }
        });
        
        // Enhanced animations
        const animatedElements = document.querySelectorAll('.animate-slide-up');
        
        const animateOnScroll = function() {
            animatedElements.forEach((element, index) => {
                const elementTop = element.getBoundingClientRect().top;
                const elementVisible = 150;
                
                if (elementTop < window.innerHeight - elementVisible) {
                    // Stagger animation delays
                    element.style.animationDelay = `${index * 0.1}s`;
                    element.classList.add('visible');
                }
            });
        };
        
        // Initial check
        animateOnScroll();
        
        // Check on scroll
        window.addEventListener('scroll', animateOnScroll);
        
        // Stagger stats items
        document.querySelectorAll('.stat-item').forEach((item, i) => item.style.animationDelay = `${0.5 + i*0.1}s`);
    });
    
    // Enhanced notification function
    function showNotification(message, type = 'success') {
        const notification = document.createElement('div');
        let bgColor, icon;
        
        switch(type) {
            case 'success':
                bgColor = 'bg-green-600';
                icon = 'fa-check-circle';
                break;
            case 'error':
                bgColor = 'bg-red-600';
                icon = 'fa-exclamation-circle';
                break;
            case 'info':
                bgColor = 'bg-blue-600';
                icon = 'fa-info-circle';
                break;
            default:
                bgColor = 'bg-indigo-600';
                icon = 'fa-check-circle';
        }
        
        notification.className = `fixed top-4 right-4 ${bgColor} text-white px-6 py-3 rounded-lg shadow-lg z-50 animate-slide-up`;
        notification.innerHTML = `<i class="fas ${icon} mr-2"></i> ${message}`;
        document.body.appendChild(notification);
        
        // Remove notification after 3 seconds
        setTimeout(() => {
            notification.style.animation = 'slideUp 0.3s ease reverse forwards';
            setTimeout(() => {
                notification.remove();
            }, 300);
        }, 3000);
        
        return notification;
    }
</script>
{% endblock %}